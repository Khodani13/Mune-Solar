(function ($) {
    "use strict";

    // Validate form fields
    $("#contactForm").on("submit", function (e) {
        e.preventDefault(); // Prevent form from submitting if there are errors

        var hasErrors = false;

        // Validate Name
        var name = $("#name").val().trim();
        if (name === "") {
            showError("#name", "Please enter your name");
            hasErrors = true;
        } else {
            clearError("#name");
        }

        // Validate Email
        var email = $("#email").val().trim();
        if (email === "" || !validateEmail(email)) {
            showError("#email", "Please enter a valid email address");
            hasErrors = true;
        } else {
            clearError("#email");
        }

        // Validate Subject
        var subject = $("#subject").val().trim();
        if (subject === "") {
            showError("#subject", "Please enter a subject");
            hasErrors = true;
        } else {
            clearError("#subject");
        }

        // Validate Phone
        var phone = $("#phone").val().trim();
        if (phone === "") {
            showError("#phone", "Please enter your phone number");
            hasErrors = true;
        } else {
            clearError("#phone");
        }

        // Validate Type of Use (Radio buttons)
        var typeOfUse = $('input[name="type_of_use"]:checked').val();
        if (!typeOfUse) {
            showError('input[name="type_of_use"]', "Please select the type of use");
            hasErrors = true;
        } else {
            clearError('input[name="type_of_use"]');
        }

        // Validate Power Requirement (Dropdown)
        var powerRequirement = $("#power_requirement").val();
        if (powerRequirement === "") {
            showError("#power_requirement", "Please select a power requirement");
            hasErrors = true;
        } else {
            clearError("#power_requirement");
        }

        // If no errors, submit the form via AJAX
        if (!hasErrors) {
            var formData = {
                name: name,
                email: email,
                phone: phone,
                subject: subject,
                type_of_use: typeOfUse,
                power_requirement: powerRequirement,
                message: $("#message").val().trim()
            };

            $.ajax({
                url: "contact.php",
                type: "POST",
                data: formData,
                dataType: "json",
                success: function (response) {
                    if (response.success) {
                        alert(response.message);
                        // Optionally reset the form
                        $("#contactForm")[0].reset();
                    } else {
                        alert(response.message);
                    }
                },
                error: function (xhr, status, error) {
                    alert("An error occurred: " + error);
                }
            });
        }
    });

    // Email validation function
    function validateEmail(email) {
        var re = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
        return re.test(email);
    }

    // Show error message
    function showError(selector, message) {
        $(selector).closest(".control-group").find(".help-block").text(message).show();
        $(selector).closest(".control-group").addClass("has-error");
    }

    // Clear error message
    function clearError(selector) {
        $(selector).closest(".control-group").find(".help-block").hide();
        $(selector).closest(".control-group").removeClass("has-error");
    }

})(jQuery);
